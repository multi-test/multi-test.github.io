import{R as g}from"./index.BQP_RuNm.js";import{y as _}from"./formatting.aYX8kOZS.js";import"./_commonjsHelpers.Bx2EM-6T.js";var d={},N={},E;function F(){if(E)return N;E=1,Object.defineProperty(N,"__esModule",{value:!0});function t(n){return function(l,s,o){return n.reduce(function(m,h){return h(m,s,o+1)},l)}}return N.default=t,N}var S={},w;function q(){if(w)return S;w=1,Object.defineProperty(S,"__esModule",{value:!0}),S.createBlankScales=void 0;var t=function(n){return{PF:n,RP:n,BP:n,GH:n,VT:n,SF:n,RE:n,MH:n}};return S.createBlankScales=t,S}var j;function H(){if(j)return d;j=1,Object.defineProperty(d,"__esModule",{value:!0}),d.rand36TScores=d.rand36ZScores=d.rand36=void 0;var t=F(),n=q(),b=[{indices:[1,2,20,22,34,36],recode:{1:100,2:75,3:50,4:25,5:0}},{indices:[3,4,5,6,7,8,9,10,11,12],recode:{1:0,2:50,3:100}},{indices:[13,14,15,16,17,18,19],recode:{1:0,2:100}},{indices:[21,23,26,27,30],recode:{1:100,2:80,3:60,4:40,5:20,6:0}},{indices:[24,25,28,29,31],recode:{1:0,2:20,3:40,4:60,5:80,6:100}},{indices:[32,33,35],recode:{1:0,2:25,3:50,4:75,5:100}}],l=new Map;b.forEach(function(e){e.indices.forEach(function(r){l.set(r,e.recode)})});var s={PF:[3,4,5,6,7,8,9,10,11,12],RP:[13,14,15,16],RE:[17,18,19],VT:[23,27,29,31],MH:[24,25,26,28,30],SF:[20,32],BP:[21,22],GH:[1,33,34,35,36]},o={PF:[10,.93,70.61,27.42],RP:[4,.84,52.97,40.78],RE:[3,.83,65.78,40.71],VT:[4,.86,52.15,22.39],MH:[5,.9,70.38,21.97],SF:[2,.85,78.77,25.43],BP:[2,.78,70.77,25.46],GH:[5,.78,56.99,21.11]},m=(0,t.default)(Array.from(l.entries()).map(function(e){var r=e[0],a=e[1];return function(c,i,u){if(u===r){var v=Number(i);!isNaN(v)&&a[v]!==void 0&&(c[r]=a[v])}return c}})),h=function(e){var r=(0,n.createBlankScales)(0);return Object.entries(s).forEach(function(a){var c=a[0],i=a[1],u=0,v=0;i.forEach(function(p){e[p]!==void 0&&(u+=e[p],v++)}),r[c]=v>0?u/v:NaN}),r},f=function(e){var r=e.reduce(m,{});return h(r)},O=function(e){if(!e||e.length!==36)return(0,n.createBlankScales)(NaN);for(var r=0;r<e.length;r++){var a=r+1,c=e[r];if(c!=null){var i=Number(c),u=l.get(a);if(!u||u[i]===void 0)return(0,n.createBlankScales)(NaN)}}};function P(e){var r=e[0],a=e[1];if(isNaN(a)||!o[r])return[r,NaN];var c=o[r][2],i=o[r][3];return[r,(a-c)/i]}function T(e){var r=e[0],a=e[1];if(isNaN(a)||!o[r])return[r,NaN];var c=o[r][2],i=o[r][3],u=(a-c)/i;return[r,50+10*u]}function y(e){return O(e)||f(e)}d.rand36=y;function B(e){return Object.fromEntries(Object.entries(e).map(P))}d.rand36ZScores=B;function M(e){return Object.fromEntries(Object.entries(e).map(T))}return d.rand36TScores=M,d}var R=H();document.addEventListener("DOMContentLoaded",Z);function Z(){try{const t=window.location.hash.substring(1),n=g.fromBase64(t),{isValid:b,errors:l}=n.validate();if(!b)throw new Error(l.join(". "));const s=R.rand36(n.answers),o=R.rand36TScores(s),m=R.rand36ZScores(s);if(!Object.values(s).every(Number.isFinite))throw new Error("Invalid scores");const h=new CustomEvent("multi-test:data",{detail:Object.fromEntries(Object.keys(s).flatMap(f=>[[f,s[f]],[`${f}_T`,o[f]],[`${f}_Z`,m[f]]]).concat([["profile_name",n.name],["profile_birthdate",_(n.birthDate)]]))});window.dispatchEvent(h)}catch(t){if(console.error("Error processing results:",t),typeof window.showToast=="function"){let n="Unknown error";t instanceof Error&&(t.message.includes("Empty hash")||t.message.includes("No answers")||t.message.includes("No scores"))&&(n="Invalid or missing test data"),window.showToast(n,{type:"error",duration:5e3})}}}

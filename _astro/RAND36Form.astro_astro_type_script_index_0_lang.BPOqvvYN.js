import{R as m}from"./index.BQP_RuNm.js";import{s as h}from"./Toast.CqyhOLyt.js";import{c as g,y as I}from"./formatting.aYX8kOZS.js";import"./_commonjsHelpers.Bx2EM-6T.js";document.addEventListener("DOMContentLoaded",()=>{const s=document.getElementById("rand36-form"),a=document.getElementById("validation-message");let o=new m;f(),p(),s&&(s.addEventListener("submit",t=>{if(t.preventDefault(),s.checkValidity()&&w()){c(),window.location.hash=o.toBase64();const n=`/${window.location.pathname.split("/")[1]}/rand-36/results${window.location.hash}`;window.location.href=n}else s.reportValidity(),E()}),s.addEventListener("keydown",function(t){if(t.key==="Enter"&&t.target instanceof HTMLElement&&t.target.tagName!=="BUTTON"){const n=document.getElementById("submit-rand36");n&&(t.preventDefault(),n.click())}}));function f(){if(window.location.hash)try{const t=window.location.hash.substring(1);o=m.fromBase64(t),y()}catch(t){typeof h=="function"&&h(String(t).split(`
`)[0],"error"),console.error("Error loading state from hash:",t),a&&(a.textContent="Invalid state data in URL",a.classList.remove("hidden"))}}function p(){document.querySelectorAll('input[type="radio"]').forEach(i=>{i.addEventListener("change",()=>{c(),window.location.hash=o.toBase64()})});const e=document.getElementById("patient-name"),n=document.getElementById("date-of-birth");e&&e.addEventListener("change",()=>{c(),window.location.hash=o.toBase64()}),n&&n.addEventListener("change",()=>{c(),window.location.hash=o.toBase64()})}function c(){const t=document.getElementById("patient-name"),e=document.getElementById("date-of-birth");t&&(o.name=t.value),e&&(o.birthDate=g(e.value)),document.querySelectorAll('input[type="radio"]:checked').forEach(i=>{const r=i,l=r.name.match(/question(\d+)/);if(l){const u=parseInt(l[1]);u>=1&&u<=36&&o.setAnswer(u,parseInt(r.value))}})}function y(){const t=document.getElementById("patient-name"),e=document.getElementById("date-of-birth");t&&(t.value=o.name),e&&o.birthDate&&(e.value=I(o.birthDate)),o.answers.forEach((n,i)=>{if(n!==0){const r=i+1,d=document.querySelector(`input[name="question${r}"][value="${n}"]`);d&&(d.checked=!0)}})}function w(){const t=new Set;document.querySelectorAll('input[type="radio"]').forEach(n=>{t.add(n.name)});const e=Array.from(t).filter(n=>!document.querySelector(`input[name="${n}"]:checked`));return e.length>0?(a&&(a.textContent=`Please answer all questions. ${e.length} questions unanswered.`,a.classList.remove("hidden")),!1):(a&&a.classList.add("hidden"),!0)}function E(){document.querySelectorAll(".unanswered").forEach(e=>{e.classList.remove("unanswered")});const t=new Set;document.querySelectorAll('input[type="radio"]').forEach(e=>{t.add(e.name)}),Array.from(t).forEach(e=>{if(!document.querySelector(`input[name="${e}"]:checked`)){const n=e.match(/question(\d+)/);if(n){const i=n[1],r=document.getElementById(`question-${i}`);r&&r.classList.add("unanswered")}}})}});
